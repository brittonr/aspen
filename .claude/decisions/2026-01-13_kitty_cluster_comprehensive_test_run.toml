# Kitty Cluster Test Suite Comprehensive Run Results
# Generated: 2026-01-13

[summary]
date = "2026-01-13"
total_test_suites = 5
total_tests_passed = 303
total_tests_failed = 11
total_tests_skipped = 3
overall_pass_rate = "96.5%"

[test_suites.kitty_cli_test]
name = "kitty-cli-test.sh"
description = "Comprehensive CLI integration tests covering all aspen-cli commands"
status = "completed"
passed = 136
failed = 6
skipped = 3
total = 145
pass_rate = "93.8%"

[[test_suites.kitty_cli_test.failures]]
test = "queue redrive"
command = "queue redrive __cli_test_xxx_queue1 1"
issue = "Redrive command failed - item_id may not exist in DLQ"

[[test_suites.kitty_cli_test.failures]]
test = "git list (verify repo)"
command = "git list --limit 10"
expected = "forge-repo name in output"
actual = "Output shows repo ID only, not full name"
issue = "Output format mismatch in git list command"

[[test_suites.kitty_cli_test.failures]]
test = "git get-blob"
command = "git get-blob --repo <repo> <hash>"
issue = "Command failed - blob retrieval issue"

[[test_suites.kitty_cli_test.failures]]
test = "git get-tree"
command = "git get-tree --repo <repo> <hash>"
issue = "Command failed - tree retrieval issue"

[[test_suites.kitty_cli_test.failures]]
test = "git get-ref"
command = "git get-ref --repo <repo> --ref refs/heads/main"
issue = "Command failed - ref retrieval issue"

[[test_suites.kitty_cli_test.failures]]
test = "git log"
command = "git log --repo <repo> --ref refs/heads/main --limit 5"
issue = "Command failed - log retrieval issue"

[test_suites.kitty_hooks_test]
name = "kitty-hooks-test.sh"
description = "Hooks subsystem CLI tests"
status = "completed"
passed = 30
failed = 0
skipped = 0
total = 30
pass_rate = "100%"
notes = "All hooks tests passed - subsystem fully functional"

[test_suites.kitty_secrets_test]
name = "kitty-secrets-test.sh"
description = "Vault-compatible secrets management CLI tests"
status = "completed"
passed = 117
failed = 3
skipped = 0
total = 120
pass_rate = "97.5%"

[[test_suites.kitty_secrets_test.failures]]
test = "pki generate-root (custom mount)"
command = "secrets pki generate-root 'Custom Mount CA' --mount <custom-pki> --ttl-days 30"
issue = "PKI generate-root fails with custom mount point"

[[test_suites.kitty_secrets_test.failures]]
test = "pki generate-root (chain test)"
command = "secrets pki generate-root 'Chain Test Root CA' --mount <chain-pki> --ttl-days 365"
issue = "PKI generate-root fails with custom mount point (consistent pattern)"

[[test_suites.kitty_secrets_test.failures]]
test = "pki issue (with alt-names)"
command = "secrets pki issue <role> test.local --alt-names www.test.local,api.test.local --ttl-days 7"
issue = "PKI certificate issuance with alt-names fails"

[test_suites.kitty_forge_test]
name = "kitty-forge-test.sh"
description = "Git/Forge operations CLI tests"
status = "partially_completed"
notes = "Test hung on 'git get-ref' command after 10 minutes - killed"

[test_suites.kitty_forge_test.results_before_hang]
passed = 6
failed = 3
tests_run = 9
last_passing_test = "git push (set main ref)"
hung_on = "git get-ref (verify)"

[[test_suites.kitty_forge_test.failures]]
test = "git list (verify repo)"
issue = "Output format mismatch - repo name not in expected format"

[[test_suites.kitty_forge_test.failures]]
test = "git get-blob (retrieve)"
issue = "Blob retrieval failed"

[[test_suites.kitty_forge_test.failures]]
test = "git get-tree"
issue = "Tree retrieval failed"

[test_suites.kitty_collab_test]
name = "kitty-collab-test.sh"
description = "Collaborative Objects (Issues & Patches/PRs) CLI tests"
status = "completed"
passed = 20
failed = 2
skipped = 0
total = 22
pass_rate = "90.9%"

[[test_suites.kitty_collab_test.failures]]
test = "patch merge"
command = "patch merge --repo <repo> <patch_id>"
issue = "Patch merge command failed"

[[test_suites.kitty_collab_test.failures]]
test = "patch list (merged)"
expected = "Test Patch"
actual = "No patches found"
issue = "Merged patches not showing in list - related to merge failure"

[analysis.working_subsystems]
hooks = "100% functional - all 30 tests pass"
kv_store = "100% functional"
counters = "100% functional"
sequences = "100% functional"
locks = "100% functional"
semaphores = "100% functional"
leases = "100% functional"
barriers = "100% functional"
rwlocks = "100% functional"
rate_limiters = "100% functional"
queues = "mostly functional - redrive has edge case issue"
service_registry = "100% functional"
docs_crdt = "100% functional"
blob_storage = "100% functional (add/list/has/get/status/protect/delete)"
jobs = "100% functional (stats/workers/list/submit/get/status/cancel)"
dns = "100% functional (set/get/scan/resolve/get-all/delete)"
sql = "100% functional"
secrets_kv = "100% functional"
secrets_transit = "100% functional"
secrets_pki = "mostly functional - custom mount and alt-names issues"

[analysis.issues_found]
forge_git_operations = """
Multiple Forge/Git read operations failing:
- git get-blob, git get-tree, git get-ref, git log all fail
- git list returns unexpected output format
- Write operations (git init, store-blob, create-tree, commit, push) work correctly
- Read operations after write operations fail - possible sync/propagation issue
"""

secrets_pki_custom_mount = """
PKI generate-root fails when using custom mount point (--mount flag).
Default mount point works correctly.
This appears to be a mount point routing issue in PKI subsystem.
"""

secrets_pki_alt_names = """
Certificate issuance with --alt-names flag fails.
Basic certificate issuance works correctly.
"""

patch_merge = """
Patch merge operation fails.
Create, list, show, approve all work.
May be related to ref propagation or conflict resolution.
"""

forge_test_hang = """
kitty-forge-test.sh hung on 'git get-ref' command for >10 minutes.
This suggests a blocking operation or deadlock in the Forge subsystem
when querying refs after push operations.
"""

[recommendations]
priority_1 = """
Investigate Forge read operations (get-blob, get-tree, get-ref, log).
These all work in isolation but fail in test scenarios.
May be a timing issue with blob replication or ref propagation.
"""

priority_2 = """
Fix PKI generate-root for custom mount points.
The --mount flag appears to route to wrong handler or not initialize PKI at mount.
"""

priority_3 = """
Debug patch merge functionality.
The operation completes but merged patches don't appear in list.
"""

priority_4 = """
Investigate git get-ref hang in kitty-forge-test.sh.
Add timeout to prevent indefinite blocking.
"""
