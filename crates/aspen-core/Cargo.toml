[package]
name = "aspen-core"
version = "0.1.0"
edition = "2024"
license = "AGPL-3.0-or-later"
description = "Core API types and traits for Aspen distributed systems"

[dependencies]
# Constants (extracted to separate crate for lighter dependencies)
aspen-constants = { path = "../aspen-constants" }

# Hybrid Logical Clock (extracted to separate crate for lighter dependencies)
aspen-hlc = { path = "../aspen-hlc" }

# Cluster types (extracted to separate crate for lighter dependencies)
aspen-cluster-types = { path = "../aspen-cluster-types" }

# KV types (extracted to separate crate for lighter dependencies)
aspen-kv-types = { path = "../aspen-kv-types" }

# Core traits (extracted to separate crate for lighter dependencies)
aspen-traits = { path = "../aspen-traits" }

# Layer types (FoundationDB-compatible tuple encoding and subspace layer)
aspen-layer = { path = "../aspen-layer" }

# Time utilities (extracted from utils.rs)
aspen-time = { path = "../aspen-time" }

# Disk space utilities (extracted from utils.rs)
aspen-disk = { path = "../aspen-disk" }

# Storage types (extracted from storage.rs)
aspen-storage-types = { path = "../aspen-storage-types" }

# Vault key validation (extracted from vault.rs)
aspen-vault = { path = "../aspen-vault" }

# Crypto types (extracted from crypto.rs)
aspen-crypto-types = { path = "../aspen-crypto-types" }

# Async traits
async-trait = "0.1"

# Serialization
serde = { version = "1.0", features = ["derive"] }
bincode = "1.3"
base64 = "0.22"
hex = "0.4"

# Error handling
thiserror = "2.0"
anyhow = "1.0"
snafu = "0.8.9"

# Async utilities
futures = "0.3.31"
tokio-util = "0.7"
tokio = { version = "1.48", features = ["sync"] }

# P2P networking (for NodeAddress wrapper)
iroh = { version = "0.95.1", features = ["discovery-local-network", "discovery-pkarr-dht"] }
iroh-base = "0.95.1"
iroh-blobs = { version = "0.97", optional = true }

# Random for HCA (High-Contention Allocator)
rand = "0.9"

# For simulation artifacts
chrono = { version = "0.4", features = ["serde"] }
serde_json = "1.0"

[dev-dependencies]
postcard = { version = "1.0", features = ["alloc"] }
# Property-based testing for layer module
proptest = "1.0"

[features]
default = []
sql = ["aspen-constants/sql"]
global-discovery = ["dep:iroh-blobs"]
